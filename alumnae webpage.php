<?php
// Alumnae data array
$alumnae = [
    [
        "name" => "Nisha Uttawani",
        "batch" => 2012,
        "branch" => "IT",
        "designation" => "Project engineer, Wipro technologies ",
        "linkedin" => "https://www.linkedin.com/in/nisha-uttawani-62ab62109?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app",
        "image" => "nisha uttwani.jpg"
    ],
    [
        "name" => "Varsha Ranjan",
        "batch" => 2011,
        "branch" => "ECE",
        "designation" => "Program Analyst at Cognizant",
        "linkedin" => "https://www.linkedin.com/in/varsha-ranjan-0114b6106?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app",
        "image" => "varsha ranjan.jpg"
    ],
    [
        "name" => "Pooja Vastri",
        "batch" => 2009,
        "branch" => "IT",
        "designation" => "Informatic assistant,Department of information technology and communication",
        "linkedin" => "https://www.linkedin.com/in/pooja-vastri-88470861?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app",
        "image" => "pooja vastri.jpg"
    ],
    [
        "name" => "Jaya Chanchalani",
        "batch" => 2009,
        "branch" => "EE",
        "designation" => "Vertical Head at Padmapat Engineers",
        "linkedin" => "https://www.linkedin.com/posts/jaya-chanchalani_adani-green-energy-achieves-10-gw-of-clean-activity-7181273919708872706-NGBo?utm_source=share&utm_medium=member_desktop",
        "image" => "jaya chanchalani.jpg"
    ],
    [
        "name" => "Chitra Rao",
        "batch" => 2009,
        "branch" => "ECE",
        "designation" => "Subordinate services,Rajasthan government",
        "linkedin" => "https://www.linkedin.com/in/chitrarao",
        "image" => "chitra rao.jpg"
    ],
    [
        "name" => "Jaya Tiwari",
        "batch" => 2009,
        "branch" => "ECE",
        "designation" => "Technical Assistant,Central University of Rajasthan",
        "linkedin" => "https://www.linkedin.com/in/jaya-tiwari-4470983a?lipi=urn%3Ali%3Apage%3Ad_flagship3_profile_view_base_contact_details%3B3Q%2Fg7GXrSuev8OmCLOTcAQ%3D%3D",
        "image" => "jaya tiwari.jpg"
    ],
    [
        "name" => "Ruby Sehra",
        "batch" => 2009,
        "branch" => "CSE",
        "designation" => "Assistant manager at SBI",
        "linkedin" => "https://www.linkedin.com/in/rubysehra",
        "image" => "ruby shera.jpg"
    ],
    [
        "name" => "Swati Sethi",
        "batch" => 2009,
        "branch" => "IT",
        "designation" => "Banker,Bank of Baroda",
        "linkedin" => "https://www.linkedin.com/in/swatisethi",
        "image" => "../img/image1.jpg"
    ],
    [
        "name" => "Nidhi",
        "batch" => 2011,
        "branch" => "IT",
        "designation" => "Incubation manager, start up oasis",
        "linkedin" => "https://www.linkedin.com/in/johndoe",
        "image" => "nidhi.jpg"
    ],
    [
        "name" => "Daivanshi Gupta",
        "batch" => 2015,
        "branch" => "ME",
        "designation" => "GET,Fluor daniel India pvt. Ltd.",
        "linkedin" => "https://www.linkedin.com/in/daivanshi-gupta?lipi=urn%3Ali%3Apage%3Ad_flagship3_profile_view_base_contact_details%3Brb5QeX76SyCj6pVRuPk5Aw%3D%3D",
        "image" => "daivanshi gupta.jpg"
    ],
    [
        "name" => "Reshma",
        "batch" => 2013,
        "branch" => "ME",
        "designation" => "Piping Engineer,Fluor pvt limited",
        "linkedin" => "https://www.linkedin.com/in/reshma-doolani-784345142?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app",
        "image" => "reshma.jpg"
    ],
    [
        "name" => "Sunita Choudhary",
        "batch" => 2013,
        "branch" => "ME",
        "designation" => "Senior UX Designer at ABC Corp",
        "linkedin" => "https://www.linkedin.com/in/johndoe",
        "image" => "sunita choudhary.jpg"
    ],
    [
        "name" => "Afsana Mansuri",
        "batch" => 2016,
        "branch" => "ME",
        "designation" => "Creative Director at XYZ Ltd",
        "linkedin" => "https://www.linkedin.com/in/afsana-mansuri-b40a2014a?lipi=urn%3Ali%3Apage%3Ad_flagship3_profile_view_base_contact_details%3BQssdjr2%2FRTmFLKY2CU%2FSIg%3D%3D",
        "image" => "afsana mansuri.jpg"
    ],
    [
        "name" => "Aditi Singh",
        "batch" => 2013,
        "branch" => "ME",
        "designation" => "faculty of mathematics ,iitian's pace for jee and medical",
        "linkedin" => "https://www.linkedin.com/in/johndoe",
        "image" => "aditi singh.jpeg"
    ],
    [
        "name" => "Anjali Chauhan",
        "batch" => 2013,
        "branch" => "ME",
        "designation" => "Engineer trainee - piping,Flour Daniel India Private limited",
        "linkedin" => "https://www.linkedin.com/in/johndoe",
        "image" => "anjali chauhan.jpg"
    ],
    [
        "name" => "Himanshi Mishra",
        "batch" => 2013,
        "branch" => "ME",
        "designation" => "Senior UX Designer at ABC Corp",
        "linkedin" => "https://www.linkedin.com/in/himanshimishra1613?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app",
        "image" => "Himanshi mishra.jpg"
    ],
    [
        "name" => "Neha Sharma",
        "batch" => 2009,
        "branch" => "CSE",
        "designation" => "Consultant,Mount Talent Consulting",
        "linkedin" => "https://www.linkedin.com/in/johndoe",
        "image" => "neha sharma.jpg"
    ],
    [
        "name" => "Akanksha Sharma",
        "batch" => 2008,
        "branch" => "ECE",
        "designation" => "Business Analyst,Tradegecko Pte Ltd Singapore",
        "linkedin" => "https://www.linkedin.com/in/johndoe",
        "image" => "akansha sharma.jpg"
    ],
    [
        "name" => "Priti Jakhar",
        "batch" => 2007,
        "branch" => "CSE",
        "designation" => "Business Analyst,Qatar National Bank",
        "linkedin" => "https://www.linkedin.com/in/priti-jakhar?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app",
        "image" => "priti jakhar.jpg"
    ]
    
];

// Function to generate CSV
if (isset($_GET['download'])) {
    header('Content-Type: text/csv');
    header('Content-Disposition: attachment; filename="alumnae_sheet.csv"');
    $output = fopen('php://output', 'w');
    fputcsv($output, ['Name', 'Batch', 'Branch', 'Designation', 'LinkedIn']);
    foreach ($alumnae as $alumna) {
        fputcsv($output, [$alumna['name'], $alumna['batch'], $alumna['branch'], $alumna['designation'], $alumna['linkedin']]);
    }
    fclose($output);
    exit;
}
?>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Precious Alumnae Page</title>
    <link rel="stylesheet" href="prec-alu.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

    <script>
        function toggleFilterPopup() {
    const popup = document.getElementById('filterPopup');
    const filterButton = document.getElementById('filterButton'); // The button that toggles the popup

    if (popup.style.display === 'block') {
        popup.style.display = 'none';
        document.removeEventListener('click', closeFilterPopup);
    } else {
        popup.style.display = 'block';

        // Use setTimeout to allow the event to finish before adding the listener
        setTimeout(() => {
            document.addEventListener('click', closeFilterPopup);
        }, 100);
    }
}

function closeFilterPopup(event) {
    const popup = document.getElementById('filterPopup');
    const filterButton = document.getElementById('filterButton');

    // Close the popup if clicked outside of both the popup and the button
    if (!popup.contains(event.target) && event.target !== filterButton) {
        popup.style.display = 'none';
        document.removeEventListener('click', closeFilterPopup);
    }
}

function filterAlumnae() {
    const nameFilter = document.getElementById('searchName').value.toLowerCase();
    const batchFilter = document.getElementById('filterBatch').value;
    const branchFilter = document.getElementById('filterBranch').value;

    const alumnaeCards = document.querySelectorAll('.alumna');
    alumnaeCards.forEach(card => {
        const name = card.getAttribute('data-name').toLowerCase();
        const batch = card.getAttribute('data-batch');
        const branch = card.getAttribute('data-branch');

        const matchesName = name.includes(nameFilter);
        const matchesBatch = !batchFilter || batch === batchFilter;
        const matchesBranch = !branchFilter || branch === branchFilter;

        // Show or hide the card based on filters
        card.style.display = matchesName && matchesBatch && matchesBranch ? 'block' : 'none';
    });
}

// Prevents closing the popup when clicking inside it
document.getElementById('filterPopup').addEventListener('click', function(event) {
    event.stopPropagation();
});

    </script>
</head>

<body>
    <nav>
        <h1>Precious Alumnae</h1>
        <div class="search-bar">
            <input type="text" id="searchName" placeholder="Search by Name" onkeyup="filterAlumnae()">
            <button class="filter-btn" onclick="toggleFilterPopup()">
                <i class="fa-solid fa-filter"></i>
            </button>
            <!-- Download button -->
            <a href="https://1drv.ms/x/c/a47fdb18a22f8606/Ea__Q5AIXXZHka8dnLGtSYEB21CRShRO3y8QuztLTtlFqg?e=EUcUP2" class="filter-btn" title="Download Alumnae Sheet">
                <i class="fa-solid fa-download"></i>
            </a>
        </div>
    </nav>

    <div class="filter-popup" id="filterPopup">
        <select id="filterBatch" onchange="filterAlumnae()">
            <option value="">Select Year</option>
            <?php for ($year = 2007; $year <= 2025; $year++) { ?>
                <option value="<?php echo $year; ?>"><?php echo $year; ?></option>
            <?php } ?>
        </select>
        <select id="filterBranch" onchange="filterAlumnae()">
            <option value="">Select Branch</option>
            <option value="CSE">CSE</option>
            <option value="IT">IT</option>
            <option value="AIML">AIML</option>
            <option value="EEE">EEE</option>
            <option value="EE">EE</option>
            <option value="ECE">ECE</option>
            <option value="ME">ME</option>
            <option value="MCA">MCA</option>
        </select>
    </div>

    <div class="alumnae-container">
        <?php
        foreach ($alumnae as $alumna) {
            echo "
            <div class='alumna' data-name='{$alumna['name']}' data-batch='{$alumna['batch']}' data-branch='{$alumna['branch']}'>
                <div class='picture'>
                    <img src='{$alumna['image']}' alt='{$alumna['name']}'>
                </div>
                <div class='info'>
                    <h2>{$alumna['name']}</h2>
                    <p><strong>{$alumna['designation']}</strong></p>
                    <p><strong>Batch:</strong> {$alumna['batch']}</p>
                    <p><strong>Branch:</strong> {$alumna['branch']}</p>
                    <a href='{$alumna['linkedin']}' target='_blank'>LinkedIn Profile</a>
                </div>
            </div>
            ";
        }
        ?>
    </div>
</body>

</html>